---
import Markdown from "@/components/content/markdown.astro";
import Wrapper from "@/components/layout/wrapper.astro";
import Link from "@/components/primitives/link.astro";
import Time from "@/components/primitives/time.astro";
import Root from "@/layouts/root.astro";

import { Content } from "@/content/pages/journals.md";

import { getCollection } from "astro:content";

const collection = await getCollection(
  "journal",
  ({ data }) => !(import.meta.env.PROD && data.draft),
);

const entries = collection.sort((a, b) => {
  return Number(b.data.publishedAt) - Number(a.data.publishedAt);
});

const meta = {
  title: ["Journal"],
  description: "journal",
  type: "article",
} satisfies Meta;
---

<Root meta={meta}>
  <Wrapper>
    <div class="flex flex-col gap-4">
      <header>
        <h1
          id="headline"
          class="text-3xl font-extrabold text-slate-800 lg:text-5xl"
        >
          Work Journal
        </h1>
      </header>

      <Markdown>
        <Content />
      </Markdown>

      <section class="mx-auto w-full max-w-196">
        <div class="flex flex-col gap-6">
          {
            entries.map((entry) => {
              return (
                <article class="flex flex-col gap-1">
                  <Time
                    datetime={entry.data.publishedAt.toISOString()}
                    class="text-xs font-bold tracking-wider text-slate-500 uppercase"
                  />
                  <h3>
                    <Link
                      href={`/journal/${entry.id}`}
                      class="hocus:underline text-lg font-bold text-slate-800"
                    >
                      {entry.data.title}
                    </Link>
                  </h3>
                </article>
              );
            })
          }
        </div>
      </section>
    </div>
  </Wrapper>
</Root>
